

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>FeaturePipeline &mdash; TensorTrade 0.2.0-beta.2 documentation</title>
  

  
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/theme_overrides.css" type="text/css" />

  
  
    <link rel="shortcut icon" href="../../_static/favicon.ico"/>
  
  
  

  
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script src="../../_static/language_data.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
        <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "document", "processClass": "math|output_area"}})</script>
    
    <script type="text/javascript" src="../../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="FeatureTransformer" href="FeatureTransformer.html" />
    <link rel="prev" title="InteractiveBrokersExchange" href="../exchanges/live/InteractiveBrokersExchange.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../index.html">
          

          
            
            <img src="../../_static/logo.jpg" class="logo" alt="Logo"/>
          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../../index.html">Home</a></li>
</ul>
<p class="caption"><span class="caption-text">Overview</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../overview/getting_started.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../overview/getting_started.html#installation">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../overview/getting_started.html#docker">Docker</a></li>
</ul>
<p class="caption"><span class="caption-text">Examples</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../examples/overview.html">Code Structure</a></li>
</ul>
<p class="caption"><span class="caption-text">Component Types</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../components.html">Components</a></li>
<li class="toctree-l1"><a class="reference internal" href="../component_types/trading_environment.html">Trading Environment</a></li>
<li class="toctree-l1"><a class="reference internal" href="../component_types/exchange.html">Exchange</a></li>
<li class="toctree-l1"><a class="reference internal" href="../component_types/feature_pipeline.html">Feature Pipeline</a></li>
<li class="toctree-l1"><a class="reference internal" href="../component_types/action_scheme.html">Action Scheme</a></li>
<li class="toctree-l1"><a class="reference internal" href="../component_types/reward_scheme.html">Reward Scheme</a></li>
<li class="toctree-l1"><a class="reference internal" href="../component_types/trading_strategy.html">Trading Strategy</a></li>
</ul>
<p class="caption"><span class="caption-text">Trading Environment</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../environments/TradingEnvironment.html">TradingEnvironment</a></li>
</ul>
<p class="caption"><span class="caption-text">Exchanges</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../exchanges/Exchange.html">Exchange</a></li>
<li class="toctree-l1"><a class="reference internal" href="../exchanges/simulated/SimulatedExchange.html">SimulatedExchange</a></li>
<li class="toctree-l1"><a class="reference internal" href="../exchanges/simulated/FBMExchange.html">FBMExchange</a></li>
<li class="toctree-l1"><a class="reference internal" href="../exchanges/live/CCXTExchange.html">CCXTExchange</a></li>
<li class="toctree-l1"><a class="reference internal" href="../exchanges/live/InteractiveBrokersExchange.html">InteractiveBrokersExchange</a></li>
</ul>
<p class="caption"><span class="caption-text">Features</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">FeaturePipeline</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#how-it-operates">How It Operates</a></li>
<li class="toctree-l2"><a class="reference internal" href="#class-parameters">Class Parameters</a></li>
<li class="toctree-l2"><a class="reference internal" href="#properties-and-setters">Properties and Setters</a></li>
<li class="toctree-l2"><a class="reference internal" href="#functions">Functions</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#private">Private</a></li>
<li class="toctree-l3"><a class="reference internal" href="#public">Public</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#use-cases">Use Cases</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="FeatureTransformer.html">FeatureTransformer</a></li>
<li class="toctree-l1"><a class="reference internal" href="scalers/MinMaxNormalizer.html">MinMaxNormalizer</a></li>
<li class="toctree-l1"><a class="reference internal" href="scalers/StandardNormalizer.html">StandardNormalizer</a></li>
<li class="toctree-l1"><a class="reference internal" href="stationarity/FractionalDifference.html">FractionalDifference</a></li>
<li class="toctree-l1"><a class="reference internal" href="indicators/TAlibIndicator.html">TAlibIndicator</a></li>
</ul>
<p class="caption"><span class="caption-text">Actions</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../actions/ActionScheme.html">ActionScheme</a></li>
<li class="toctree-l1"><a class="reference internal" href="../actions/ContinuousActions.html">ContinuousActions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../actions/DiscreteActions.html">DiscreteActions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../actions/MultiDiscreteActions.html">MultiDiscreteActions</a></li>
</ul>
<p class="caption"><span class="caption-text">Rewards</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../rewards/RewardScheme.html">Reward Scheme</a></li>
<li class="toctree-l1"><a class="reference internal" href="../rewards/RiskAdjustedReturns.html">Risk Adjusted Returns</a></li>
<li class="toctree-l1"><a class="reference internal" href="../rewards/SimpleProfit.html">Simple Profit</a></li>
</ul>
<p class="caption"><span class="caption-text">Learning Agents</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../agents/learning_agents.html">Learning Agents</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../agents/stable_baselines.html">Stable Baselines</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../agents/tensorforce.html">Tensorforce</a></li>
</ul>
<p class="caption"><span class="caption-text">Strategies</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../strategies/TradingStrategy.html">TradingStrategy</a></li>
<li class="toctree-l1"><a class="reference internal" href="../strategies/StableBaselinesTradingStrategy.html">StableBaselinesTradingStrategy</a></li>
<li class="toctree-l1"><a class="reference internal" href="../strategies/TensorforceTradingStrategy.html">TensorforceTradingStrategy</a></li>
</ul>
<p class="caption"><span class="caption-text">API reference</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../api/modules.html">API reference</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">TensorTrade</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>FeaturePipeline</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../../_sources/components/features/FeaturePipeline.md.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<div class="section" id="featurepipeline">
<h1>FeaturePipeline<a class="headerlink" href="#featurepipeline" title="Permalink to this headline">¶</a></h1>
<p>Feature pipelines are meant for transforming observations from the environment into meaningful features for an agent to learn from. If a pipeline has been added to a particular exchange, then observations will be passed through the <code class="docutils literal notranslate"><span class="pre">FeaturePipeline</span></code> before being output to the environment.</p>
<p>For example, a feature pipeline could normalize all price values, make a time series stationary, add a moving average column, and remove an unnecessary column, all before the observation is returned to the agent.</p>
<p>Feature pipelines can be initialized with an arbitrary number of comma-separated transformers. Each <code class="docutils literal notranslate"><span class="pre">FeatureTransformer</span></code> needs to be initialized with the set of columns to transform, or if nothing is passed, all input columns will be transformed.</p>
<p>Each feature transformer has a transform method, which will transform a single observation (a <code class="docutils literal notranslate"><span class="pre">pandas.DataFrame</span></code>) from a larger data set, keeping any necessary state in memory to transform the next frame. For this reason, it is often necessary to reset the FeatureTransformer periodically. This is done automatically each time the parent <code class="docutils literal notranslate"><span class="pre">FeaturePipeline</span></code> or <code class="docutils literal notranslate"><span class="pre">Exchange</span></code> is reset.</p>
<div class="section" id="how-it-operates">
<h2>How It Operates<a class="headerlink" href="#how-it-operates" title="Permalink to this headline">¶</a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">FeaturePipeline</span></code> has a setup that resembles the <code class="docutils literal notranslate"><span class="pre">keras</span></code> library. The concept is simple:</p>
<ol class="simple">
<li><p>We take in an observation of data (price information), usually in the form of a pandas dataframe.</p></li>
<li><p>We take the observation and effectively run it through all declared ways of transforming that data inside of the FeaturePipeline and turn the result as a <code class="docutils literal notranslate"><span class="pre">gym.space</span></code>.</p></li>
</ol>
<p>Just like kera’s <code class="docutils literal notranslate"><span class="pre">Sequential</span></code> module, it accepts a list inside of its constructor and iterates through each piece on call. To draw on parallels, look at <code class="docutils literal notranslate"><span class="pre">keras</span></code>:</p>
<div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="n">model</span> <span class="o">=</span> <span class="n">Sequential</span><span class="p">([</span>
    <span class="n">Dense</span><span class="p">(</span><span class="mi">32</span><span class="p">,</span> <span class="n">input_shape</span><span class="o">=</span><span class="p">(</span><span class="mi">500</span><span class="p">,)),</span>
    <span class="n">Dense</span><span class="p">(</span><span class="mi">32</span><span class="p">)</span>
<span class="p">])</span>
</pre></div>
</div>
</div>
<div class="section" id="class-parameters">
<h2>Class Parameters<a class="headerlink" href="#class-parameters" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">steps</span></code></p>
<ul>
<li><p>A list of feature transformations to apply to observations.</p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">dtype</span></code></p>
<ul>
<li><p>The <code class="docutils literal notranslate"><span class="pre">dtype</span></code> elements in the pipeline should be cast to.</p></li>
</ul>
</li>
</ul>
</div>
<div class="section" id="properties-and-setters">
<h2>Properties and Setters<a class="headerlink" href="#properties-and-setters" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">steps</span></code></p>
<ul>
<li><p>A list of feature transformations to apply to observations.</p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">dtype</span></code></p>
<ul>
<li><p>The <code class="docutils literal notranslate"><span class="pre">dtype</span></code> that elements in the pipeline should be input and output as.</p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">reset</span></code></p>
<ul>
<li><p>Reset all transformers within the feature pipeline.</p></li>
</ul>
</li>
</ul>
</div>
<div class="section" id="functions">
<h2>Functions<a class="headerlink" href="#functions" title="Permalink to this headline">¶</a></h2>
<p>Below are the functions that the <code class="docutils literal notranslate"><span class="pre">FeaturePipeline</span></code> uses to effectively operate.</p>
<div class="section" id="private">
<h3>Private<a class="headerlink" href="#private" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">_transform</span></code></p>
<ul>
<li><p>Utility method for transforming observations via a list of <em>make changes here</em> <code class="docutils literal notranslate"><span class="pre">FeatureTransformer</span></code> objects.</p></li>
<li><p>In other words, it runs through all of the <code class="docutils literal notranslate"><span class="pre">steps</span></code> in a for loop, and casts the response.</p></li>
</ul>
</li>
</ul>
<p><strong>The code from the transform function:</strong>
As you see, it iterates through every step and adds the observation to the dataframe.</p>
<div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">transformer</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_steps</span><span class="p">:</span>
    <span class="n">observations</span> <span class="o">=</span> <span class="n">transformer</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">observations</span><span class="p">)</span>
</pre></div>
</div>
<p>At the end the observations are converted into a ndarray so that they can be interpreted by the agent.</p>
</div>
<div class="section" id="public">
<h3>Public<a class="headerlink" href="#public" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">reset</span></code></p>
<ul>
<li><p>Reset all transformers within the feature pipeline.</p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">transform</span></code></p>
<ul>
<li><p>Apply the pipeline of feature transformations to an observation frame.</p></li>
</ul>
</li>
</ul>
</div>
</div>
<div class="section" id="use-cases">
<h2>Use Cases<a class="headerlink" href="#use-cases" title="Permalink to this headline">¶</a></h2>
<p><strong>Use Case #1: Initiate Pipeline</strong></p>
<div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">tensortrade.features</span> <span class="kn">import</span> <span class="n">FeaturePipeline</span>
<span class="kn">from</span> <span class="nn">tensortrade.features.scalers</span> <span class="kn">import</span> <span class="n">MinMaxNormalizer</span>
<span class="kn">from</span> <span class="nn">tensortrade.features.stationarity</span> <span class="kn">import</span> <span class="n">FractionalDifference</span>
<span class="kn">from</span> <span class="nn">tensortrade.features.indicators</span> <span class="kn">import</span> <span class="n">SimpleMovingAverage</span>

<span class="n">price_columns</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;open&quot;</span><span class="p">,</span> <span class="s2">&quot;high&quot;</span><span class="p">,</span> <span class="s2">&quot;low&quot;</span><span class="p">,</span> <span class="s2">&quot;close&quot;</span><span class="p">]</span>
<span class="n">normalize_price</span> <span class="o">=</span> <span class="n">MinMaxNormalizer</span><span class="p">(</span><span class="n">price_columns</span><span class="p">)</span>
<span class="n">moving_averages</span> <span class="o">=</span> <span class="n">SimpleMovingAverage</span><span class="p">(</span><span class="n">price_columns</span><span class="p">)</span>
<span class="n">difference_all</span> <span class="o">=</span> <span class="n">FractionalDifference</span><span class="p">(</span><span class="n">difference_order</span><span class="o">=</span><span class="mf">0.6</span><span class="p">)</span>
<span class="n">feature_pipeline</span> <span class="o">=</span> <span class="n">FeaturePipeline</span><span class="p">(</span><span class="n">steps</span><span class="o">=</span><span class="p">[</span><span class="n">normalize_price</span><span class="p">,</span>
                                          <span class="n">moving_averages</span><span class="p">,</span>
                                          <span class="n">difference_all</span><span class="p">])</span>

<span class="n">exchange</span><span class="o">.</span><span class="n">feature_pipeline</span> <span class="o">=</span> <span class="n">feature_pipeline</span>
</pre></div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="FeatureTransformer.html" class="btn btn-neutral float-right" title="FeatureTransformer" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="../exchanges/live/InteractiveBrokersExchange.html" class="btn btn-neutral float-left" title="InteractiveBrokersExchange" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>